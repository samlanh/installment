 <?php
	$tr=Application_Form_FrmLanguages::getCurrentlanguage();
	$this->headTitle($tr->translate("Dashboard Property Management System"));
	echo $this->headTitle();
	$db = new Home_Model_DbTable_DbDashboard();
	$base_url = Application_Form_FrmMessage::getUrl("/");
?>
<style>
 .dijitHidden{
 	display: none;
}
 </style>
<!--Morris Chart CSS -->
<link rel="stylesheet" href="<?php echo $this->baseUrl()."/"?>dashboard/plugins/morris/morris.css">
<!-- Icons CSS -->
<link href="<?php echo $this->baseUrl()."/"?>dashboard/css/icons.css" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="<?php echo $this->baseUrl()."/"?>dashboard/css/style.css" rel="stylesheet">
<div id="page-wrapper">
	<!-- Page content start -->
	<div class="page-contentbar">
		<!-- START PAGE CONTENT -->
		<div id="page-right-content">
			<div class="container">
				 <div class="row">
					<div class="col-lg-6">
						<!-- 
						<div class="card-box">
							<div  style="padding-left: 0; margin-left: 0; margin-top: 0;">
								<ul id="module-image">						
									<li style="text-align:center;">
										<a href="<?php //echo $this->baseUrl()."/report/loan/rpt-sold"?>">
											<img title="<?php //echo $tr->translate("LOAN_DISBURSE");?>" src="<?php //echo $this->baseUrl()."/images/icon/reportIcon.png"?>" alt="Customer">							
											<span style="margin-top: 5px; font-size: 14px; font-weight: bold; color: #000000"><h5 data-bind="text: lang.lang.accounting" style="margin-top: 5px; display: inline-block;"><?php //echo $tr->translate("LOAN_DISBURSE");?></h5></span>
										</a>
									</li>
									<li style="text-align:center;">
										<a href="<?php //echo $this->baseUrl()."/report/paramater/rpt-daily-cash"?>">
											<img title="<?php //echo $tr->translate("REPORT_DAILY_CASH");?>" src="<?php //echo $this->baseUrl()."/images/icon/reportIncomeIcon.png"?>" alt="Customer">							
											<span style="margin-top: 5px; font-size: 14px; font-weight: bold; color: #000000"><h5 data-bind="text: lang.lang.accounting" style="margin-top: 5px; display: inline-block;"><?php //echo $tr->translate("REPORT_DAILY_CASH");?></h5></span>
										</a>
									</li>
									<li style="text-align:center;">
										<a href="<?php //echo $this->baseUrl()."/report/paramater/rpt-cancel-sale"?>">
											<img title="<?php //echo $tr->translate("CANCEL_REPORT");?>" src="<?php //echo $this->baseUrl()."/images/icon/reportCancelIcon.png"?>" alt="Customer">							
											<span style="margin-top: 5px; font-size: 14px; font-weight: bold; color: #000000"><h5 data-bind="text: lang.lang.accounting" style="margin-top: 5px; display: inline-block;"><?php //echo $tr->translate("CANCEL_REPORT");?></h5></span>
										</a>
									</li>
									<li style="text-align:center;">
										<a href="<?php //echo $this->baseUrl()."/report/loan/rpt-loan-outstanding"?>">
											<img title="<?php //echo $tr->translate("LOAN_OUTSTADING");?>" src="<?php //echo $this->baseUrl()."/images/icon/balanceIcon.png"?>" alt="Customer">							
											<span style="margin-top: 5px; font-size: 14px; font-weight: bold; color: #000000"><h5 data-bind="text: lang.lang.accounting" style="margin-top: 5px; display: inline-block;"><?php //echo $tr->translate("LOAN_OUTSTADING");?></h5></span>
										</a>
									</li>
								</ul>
							</div>
						</div>
						 -->
						<div class="card-box">
							<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
								<div class="accounting-management text-center">
									<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 capital-box" style="width: 100%; background: #203864; color: #fff">
										<span data-bind="text: txnRecorded">0<?php //if ($this->netIncome<0){ echo "$ ".number_format(abs($this->netIncome),2);}else{ echo "$ ".number_format($this->netIncome,2);}?></span>
										<p class="month" style="width: 70%; text-align: center; margin: 0 auto;" data-bind="text: lang.lang.transactions_recorded"><?php echo $tr->translate("Net Income")?></p>
									</div>
									<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0;">
										<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 capital-box" style="background: #0077c5;">
											<span data-bind="text: currentRatio">0<?php //echo "$ ".number_format($this->totalIncome,2);?></span> 
											<p class="month" data-bind="text: lang.lang.current_ratio"><?php echo $tr->translate("Total Income")?></p>
										</div>
										<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 capital-box" style="background: #21abf6; color: #fff;">
											<span data-bind="text: quickRatio">0<?php //echo "$ ".number_format($this->totalExpense,2);?></span> 
											<p class="month" style="color: #fff;" data-bind="text: lang.lang.quick_ratio"><?php echo $tr->translate("Total Expense")?></p>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="card-box">
							<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
								<h4 class="m-t-0"><?php echo $tr->translate("Monthly Sale")?></h4>
								<div class="text-center">
									<ul class="list-inline chart-detail-list">
										<li>
											<h5 class="font-normal"><i class="fa fa-circle m-r-10 text-primary"></i><?php echo $tr->translate("Number Of Sale")?></h5>
										</li>
									</ul>
								</div>
								<div id="dashboard-bar-stacked" style="height: 200px;"></div>
							</div>
							<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
								<h4 class="m-t-0"><?php echo $tr->translate("Monthly Net Income")?></h4>
								<div class="text-center">
									<ul class="list-inline chart-detail-list">
										<li>
											<h5 class="font-normal"><i class="fa fa-circle m-r-10 text-muted"></i><?php echo $tr->translate("Net Income")?></h5>
										</li>
									</ul>
								</div>
								<div id="dashboard-bar-income" style="height: 200px;"></div>
							</div>
						</div> 
					</div> <!-- end col -->	  
					 <div class="col-lg-6">
					 	
						<div class="card-box">
							<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
								<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
									<p><span data-bind="text: lang.lang.performance"><?php echo $tr->translate("Property Infomation")?></span></p>
									<table class="performance">
										<tbody>
											<tr>
												<td><a href="<?php echo $this->baseUrl()."/report/paramater/rpt-properties";?>"><span data-bind="text: lang.lang.income"><?php echo $tr->translate("All Property")?></span></a></td>
												<td></td>
												<td align="right"><span data-bind="text: obj.income"><?php echo $this->allProperty;?></span></td>
											</tr>
											<tr>
												<td><span data-bind="text: lang.lang.expense"><?php echo $tr->translate("Property Sold")?></span></td>
												<td></td>
												<td align="right"><span data-bind="text: obj.expense"><?php echo $this->propertySold;?></span></td>
											</tr>
											<tr>
												<td><b><span data-bind="text: lang.lang.net_income"><?php echo $tr->translate("Property Available")?></span></b></td>
												<td></td>
												<td align="right"><b data-bind="text: obj.net_income"><?php echo $this->availableProperty;?></b></td>
											</tr>
										</tbody>
									</table>
								</div>
								<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
									<p><span data-bind="text: lang.lang.performance"><?php echo $tr->translate("Customer / Agency Infomation")?></span></p>
									<table class="performance">
										<tbody>
											<tr>
												<td><a href="<?php echo $this->baseUrl()."/report/groupmember/rpt-client";?>"><span data-bind="text: lang.lang.income"><?php echo $tr->translate("Customers")?></span></a></td>
												<td></td>
												<td align="right"><span data-bind="text: obj.income"><?php echo $this->AllClient;?></span></td>
											</tr>
											<tr>
												<td><a href="<?php echo $this->baseUrl()."/report/paramater/rpt-staff";?>"><span data-bind="text: lang.lang.expense"><?php echo $tr->translate("Agency")?></span></a></td>
												<td></td>
												<td align="right"><span data-bind="text: obj.expense"><?php echo $this->CountAllAgency;?></span></td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
							<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
								<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
									<p><span data-bind="text: lang.lang.performance"><?php echo $tr->translate("Sale Information")?></span></p>
									<div class="widget-body alert-info welcome-nopadding">
											<table width="100%" class="saleInfo">
												<thead>
													<tr align="center">
														<td>										
															&nbsp;
														</td>
														<td>
															<span data-bind="text: obj.ar_customer"><?php echo $tr->translate("Number Of Sale")?></span>
														</td>
														<td>
															<span data-bind="text: obj.ar_overdue"><?php echo $tr->translate("Sale Income")?></span>
														</td>
													</tr>
												</thead>
												<tbody>
													<tr align="left">
														<td class="border-rig">										
															<span data-bind="text: obj.ar_open"><?php echo $tr->translate("Total Sale")?></span>
														</td>
														<td align="center">
															<span data-bind="text: obj.ar_customer"><?php echo $this->CountAllSale['total'];?></span>
														</td>
														<td align="center">
															<span data-bind="text: obj.ar_overdue">0<?php //echo "$ ".number_format($this->CountAllSale['totalAmount'],2);?></span>
														</td>
													</tr>
													<tr align="left">
														<td class="border-rig">										
															<span data-bind="text: obj.ar_open"><?php echo $tr->translate("Completed Sale")?></span>
														</td>
														<td align="center">
															<span data-bind="text: obj.ar_customer"><?php echo $this->CountCompletedSale['total'];?></span>
														</td>
														<td align="center">
															<span data-bind="text: obj.ar_overdue"><?php echo "$ ".number_format($this->CountCompletedSale['totalAmount'],2);?></span>
														</td>
													</tr>
													<tr align="left">
														<td class="border-rig">										
															<span data-bind="text: obj.ar_open"><?php echo $tr->translate("Canceled Sale")?></span>
														</td>
														<td align="center">
															<span data-bind="text: obj.ar_customer"><?php echo $this->CountCanceledSale;?></span>
														</td>
														<td align="center">
															<span data-bind="text: obj.ar_overdue"><?php echo "$ ".number_format($this->CancelPropertyAmount,2);?></span>
														</td>
													</tr>
												</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
						
						<div class="card-box">
							<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
								<div class="accounting-management text-center">
									<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0;">
										<a title="<?php echo $tr->translate("CUSTOMER_PAYMENTLIST")?>" href="<?php echo $this->baseUrl()."/report/loan/rpt-loancollect";?>">
										<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 capital-box" style="background: #0f575b;">
											<span data-bind="text: currentRatio"><?php echo count($this->customerNearlyPayment);?></span> 
											<p class="month" data-bind="text: lang.lang.current_ratio"><?php echo $tr->translate("CUSTOMER_PAYMENTLIST")?></p>
										</div>
										</a>
										<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 capital-box" style="background: #203864; color: #fff;">
											<span data-bind="text: quickRatio"><?php echo count($this->customerNearlyAgreement);?></span> 
											<p class="month" style="color: #fff;" data-bind="text: lang.lang.quick_ratio"><?php echo $tr->translate("MAKE_AGREEMENTLIST")?></p>
										</div>
									</div>
								</div>
							</div>
						</div>  
					</div> <!-- end col -->	  
				</div> <!-- end row -->
				
                 <div class="row-fluid">
					<div style="margin-top: 10px; margin-left: 0;" align="center">
						
					</div>	
				</div>       
			</div>
		</div>
		<!-- END PAGE CONTENT -->
	</div>

</div>


  
       
<script src="<?php echo $this->baseUrl()."/"?>dashboard/js/jquery-2.1.4.min.js"></script>
<!--Morris Chart-->
<script src="<?php echo $this->baseUrl()."/"?>dashboard/plugins/morris/morris.min.js"></script>
<script src="<?php echo $this->baseUrl()."/"?>dashboard/plugins/raphael/raphael-min.js"></script>

 <!-- Dashboard init 
<script src="<?php echo $this->baseUrl()."/"?>dashboard/pages/jquery.dashboard.js"></script>-->
<?php 
   $start_year = date("Y-m-d",strtotime(" -6 month"));
?>
<script>
var $stckedData  = [];
//creating Stacked chart
var $stckedData  = [
    <?php for ($i=0; $i<=6; $i++ ){ 
    	$year = date("Y-m",strtotime("$start_year+$i month"));
    	$Sale = $db->countSaleByYearMonth($year);
    	//$app = $db->getBookingByAppByYear($year);
    ?>
    { y: '<?php echo $year;?>', a: <?php echo $Sale;?>},
    <?php }?>
];
var $stckedDataIncmoe  = [];
var $stckedDataIncmoe  = [
  <?php for ($i=0; $i<=6; $i++ ){ 
   $year = date("Y-m",strtotime("$start_year+$i month"));
   $netIncome =0; //$db->getMonthlyNetIncomeInGrap($year);//ប្រភព យឺត
    ?>
     { y: '<?php echo $year;?>', a: <?php echo $netIncome;?>},
    <?php }?>
];
/**
* Theme: SimpleAdmin Admin Template
* Author: Coderthemes
* Morris Chart
*/
!function($) {
    "use strict";
    var Dashboard = function() {};
    //creates Stacked chart
    Dashboard.prototype.createStackedChart  = function(element, data, xkey, ykeys, labels, lineColors) {
        Morris.Bar({
            element: element,
            data: data,
            xkey: xkey,
            ykeys: ykeys,
            stacked: true,
            labels: labels,
            hideHover: 'auto',
            resize: true, //defaulted to true
            gridLineColor: '#ccc',
            barColors: lineColors
        });
    },
    Dashboard.prototype.init = function() {
        this.createStackedChart('dashboard-bar-stacked', $stckedData, 'y', ['a'], ['<?php echo $tr->translate("Number Of Sale")?>'], ['#458bc4']);
    },
    //init
    $.Dashboard = new Dashboard, $.Dashboard.Constructor = Dashboard


    var DashboardII = function() {};
    //creates Stacked chart
    DashboardII.prototype.createStackedChart  = function(element, data, xkey, ykeys, labels, lineColors) {
        Morris.Bar({
            element: element,
            data: data,
            xkey: xkey,
            ykeys: ykeys,
            stacked: true,
            labels: labels,
            hideHover: 'auto',
            resize: true, //defaulted to true
            gridLineColor: '#ccc',
            barColors: lineColors
        });
    },
    DashboardII.prototype.init = function() {
        this.createStackedChart('dashboard-bar-income', $stckedDataIncmoe, 'y', ['a'], ['<?php echo $tr->translate("Net Income")?>'], ['#144673']);
    },
    //init
    $.DashboardII = new DashboardII, $.DashboardII.Constructor = DashboardII
    
}(window.jQuery),

//initializing
function($) {
    "use strict";
    $.Dashboard.init();
    $.DashboardII.init();
}(window.jQuery);

</script>
 <!-- App Js -->
<script src="<?php echo $this->baseUrl()."/"?>dashboard/js/jquery.app.js"></script>

