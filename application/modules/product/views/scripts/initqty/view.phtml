<?php 
	$tr = Application_Form_FrmLanguages::getCurrentlanguage();
	$dbparmeter = new Report_Model_DbTable_DbParamater();
	$boreyName = $tr->translate("BRAND_TITLE");
	
	$imagelogo = $this->baseUrl()."/images/logo.jpg";
	if (!empty($this->agreement['project_logo'])){
		$imagelogo = $this->baseUrl()."/images/projects/".$this->agreement['project_logo'];
	}
	$projectName="";
	if (!empty($this->agreement['project_name'])){
		$projectName = " ".$this->agreement['project_name'];
	}
	
	$companyAddress=$this->keyValue['footer_branch'];
	$companyTel="&#9743; ".$this->keyValue['tel-client'];
	$companyEmail="";
	if(!empty($this->keyValue['email_client'])){
		$companyEmail=" &#x2709; ".$this->keyValue['email_client'];
	}
	$companyContact=$companyTel.$companyEmail;
	
	$rs = $this->rsProduct;
	$proLocation = $this->rsProLocation;
?>
<meta charset="utf-8">
<title><?php echo $tr->translate("PRODUCT_DETAIL_INFO");?></title>
<style>
	#printfooter{display: none !important;}
</style>
<div class="reportblog">
	<div class="card-box">
       	<div class="col-sm-12 border-botom">
	   		<div class="col-sm-8 pd-0">
	    		<h4 class="m-b-0"><i class="fa fa-file" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<?php echo $tr->translate('PRODUCT_DETAIL_INFO');?></h4>
    		</div>
    		<div class="col-sm-4 text-right">
    		</div>
    	</div>
    </div>
<table style="font-family: 'Times New Roman','Khmer OS Battambang'; width:100%;"  >
	<tr>
    	<td align="center">
    		<div id="divPrint" >
				<style>		
					tr td h2,td span,p,pre,span{ font-size: 12px ; line-height:18px; font-family: "Times New Roman","Khmer OS Battambang";}
					ul.headReport, ul.reportTitle {
						margin: 0;
						padding: 0;
						list-style: none;
					}
					ul.headReport li span, ul.headReport li {
						line-height: 18px;
						text-align: center;
						font-size: 14px;
						font-family: "Times New Roman","Khmer OS Muol Light";
					}
					ul.headReport li.small-text, ul.headReport li.small-text span {
						line-height: 14px;
						text-align: center;
						font-size: 11px;
						font-family: "Times New Roman","Khmer OS Battambang";
					}
					ul.reportTitle {
						background: #ffffff;
						display: block;
						position: absolute;
						top: -20px;
						width: 100%;
					}
					
					table.content-data {
						margin-top: 5px;
						font-family: "Times New Roman","Khmer OS Battambang";
						border-collapse:collapse;
						
						width: 100%;
					}
					tr.section-bg {
						background: #337ab7;
						color: #fff;
					}
					tr.section-bg td {
						font-size: 12px;
						font-weight: 600;
						text-transform: uppercase;
					}
					table.content-data td {
						padding: 1px 5px;
						vertical-align: top;
					}
					ul.dataValue {
						margin: 0;
						padding: 0;
						list-style: none;
					}
					
					.blgLeft, .blgRight {
						display: inline-block;
						vertical-align: top;
						line-height: 14px;
					}
					.blgLeft {
						min-width: 60px;
						width:20%;
					}
					.left,.right,.center{width:180px;}
					.line-movelist{background:#eee;}
]					
					body {
						position: relative;
					}
					@page  
					{ 
						margin: 1mm 5mm 5mm 5mm;  
					} 
					.hover:hover{
						background:#dde9f3;
						border:1px dotted #000;
					}
					.hover{clear: both;}
				</style>
				<table class="tableTop" style="width:100%;border-bottom: double 5px #337ab7;">
					<tbody>
						<tr>
							<td width="20%" id="projectlogo"><img src="<?php echo $imagelogo;?>" style=" height:70px; max-width: 100%; "></td>
							<td width="60%" valign="top" style=" padding-bottom: 30px;">
								<ul class="headReport">
									<li style="font-size:16px; " id="companyTitle"><?php echo $tr->translate("BRAND_TITLE");?></li>
									<li><span id="companyTitleEn"><?php echo $tr->translate("BRAND_TITLE_EN");?></span></li>
									<li class="small-text"><span id="companyAddress"><?php echo $companyAddress;?></span></li>
									<li class="small-text"><span id="companyPhone"><?php echo $companyContact;?></span></li>
								</ul>
							</td>
							<td width="20%">
								<span class="project-name" id="projectName"></span>
							</td>
						</tr> 
						<tr>
							<td> </td>
							<td style="text-align: center;position: relative;">
								<ul class="reportTitle">
									<li style="font-size:16px; "><span id="reportTitle" style="font-family:'Khmer OS Muol Light';"><?php echo $tr->translate("PRODUCT_DETAIL_INFO");?></span></li>
									<li style="font-size:12px;"><span id="staff_lbl"></span></li>
								</ul>
							</td>
							<td></td>
						</tr> 
					</tbody>
				</table>
				<br />
				<table class="content-data" border="1"​  width="100%">
					<tr class="section-bg">
						<td colspan="3"><i class="fa fa-cubes" aria-hidden="true"></i> <?php echo $tr->translate("PRODUCT_INFO");?> </td>
					</tr>
					<tr>
						<td style="border-right: none; border-bottom: none;">
							<ul class="dataValue">
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("PRODUCT_NAME");?>:</span>
									</div>
									<div class="blgRight"><strong><span class="values-row"><?php echo $rs['proName'];?></span></strong></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("PRODUCT_CODE");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['proCode'];?></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("BAR_CODE");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['barCode'];?></span></div>
								</li>
							</ul>
						</td>
						<td style="border-left: none;border-right: none; border-bottom: none;">
							<ul class="dataValue">
								<li>
									<div class="blgLeft">
										<span class="title-row"></span><br />
									</div>
									<div class="blgRight"><span class="values-row"></span></div>
								</li>
							</ul>
						</td>
						<td style="border-left: none; border-bottom: none;">
							<ul class="dataValue">
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("CREATE_DATE");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo date('d-m-Y',strtotime($rs['createDate']));?></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("BY_USER");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['user'];?></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("MODIFY_BY");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo empty($rs['modifyDate'])?"N/A": date('d-m-Y',strtotime($rs['modifyDate']));?></span></div>
								</li>
							</ul>
						</td>
					</tr>
				</table>
				<table class="content-data" border="1"​  width="100%">
					<tr class="section-bg">
						<td colspan="3"><i class="fa fa-th-list" aria-hidden="true"></i> <?php echo $tr->translate("SERVICE_PRODUCT");?> </td>
					</tr>
					<tr>
						<td style="border-right: none; border-bottom: none;">
							<ul class="dataValue">
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("SERVICE_PRODUCT");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['isService'];?></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("IS_COUNT_STOCK");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['isCountStock'];?></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("PRODUCT_CATEGORY");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['categoryName'];?></span></div>
								</li>
							</ul>
						</td>
						<td style="border-left: none;border-right: none; border-bottom: none;">
							<ul class="dataValue">
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("MEASURE");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['MeasureName'];?></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"></span><br />
									</div>
									<div class="blgRight"><span class="values-row"></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("labelMeasure");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo number_format($rs['measureValue'],2).$rs['measureLabel'];?></span></div>
								</li>
							</ul>
						</td>
						<td style="border-left: none; border-bottom: none;">
							<ul class="dataValue">
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("BUDGET_ITEM");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['budgetTitle'];?></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"></span><br />
									</div>
									<div class="blgRight"><span class="values-row"></span></div>
								</li>
								<li>
									<div class="blgLeft">
										<span class="title-row"><?php echo $tr->translate("NOTE");?> :</span><br />
									</div>
									<div class="blgRight"><span class="values-row"><?php echo $rs['note'];?></span></div>
								</li>
							</ul>
						</td>
					</tr>
				</table>
				
				<table class="content-data" border="1"​  width="100%">
					<tr class="section-bg">
						<td colspan="3"><i class="fa fa-th-large" aria-hidden="true"></i> <?php echo $tr->translate("PRODUCT_LOCATION");?> </td>
					</tr>
					<tr >
						<td colspan="3">
							<ul class="dataValue">
									<li>
										<div class="blgLeft">
											<span class="title-row"><strong><i class="fa fa-university" aria-hidden="true"></i> <?php echo $proLocation['projectName'];?></strong></span><br />
										</div>
										<div class="blgRight"><span class="values-row" style="font-size:14px;"><strong><?php echo number_format($proLocation['qty'],2).'&nbsp; '.$rs['measureLabel'];?></strong></span></div>
										<div class="blgRight"><span class="values-row"><strong> <i class="fa fa-money" aria-hidden="true"></i> <?php echo $tr->translate("COSTING").$proLocation['costing'];?></strong></span></div>
									</li>
							</ul>
						</td>
					</tr>
				</table>

				<table class="content-data" border="1"​  width="100%">
					<tr class="section-bg">
						<td colspan="3"><i class="fa fa-th-large" aria-hidden="true"></i> <?php echo $tr->translate("PRODUCT_COSTING");?> </td>
					</tr>
					<tr >
						<td colspan="3">
							<table style="font-size: 12px;">
								<tr style="line-height: 30px; font-weight: bold;">
										<td><i class="fa fa-arrows-v" aria-hidden="true"></i>ល.រ<br />No.</td>
										<td class="right"><i class="fa fa-calendar" aria-hidden="true"></i></strong>&nbsp;&nbsp;កាលបិរច្ឆេទ <br />  Date</td>
										<td class="center"><i class="fa fa-money" aria-hidden="true"></i>តម្លៃដើម <br />Unit Price</strong></td>
									</tr>
								<?php if(!empty($this->getProductCosting))foreach($this->getProductCosting as $key=> $row){?>
									<tr class="hover <?php if($key%2===0)echo "line-movelist";?>">
										<td width="50px">&nbsp;&nbsp;<?php echo $key+1;?>&nbsp;&nbsp;</td>
										<td class="right"><i class="fa fa-calendar" aria-hidden="true"></i>&nbsp;<?php echo date("d-m-Y",strtotime($row['date']));?></td>		
										<td class="center"><?php echo $row['costing'];?></td>
									</tr>
								<?php }?>
							</table>
						</td>
					</tr>
				</table>
				
				<table class="content-data" border="1"​  width="100%">
					<tr class="section-bg">
						<td colspan="3"><i class="fa fa-th-large" aria-hidden="true"></i> <?php echo $tr->translate("PRODUCT_MOVEMENT");?> </td>
					</tr>
					<tr >
						<td colspan="3">
							<table style="font-size: 12px;">
								<tr style="line-height: 30px; font-weight: bold;">
										<td><i class="fa fa-arrows-v" aria-hidden="true"></i>ល.រ<br />No.</td>
										<td class="center"><i class="fa fa-list-alt" aria-hidden="true"></i>&nbsp;ប្រភេទប្រតិបត្តិការ <br />Transaction Type</td>
										<td class="right"><i class="fa fa-calendar" aria-hidden="true"></i></strong>&nbsp;&nbsp;ថ្ងៃធ្វើប្រតិបត្តិការ <br /> Transaction Date</td>
										<td class="center"><i class="fa fa-sort-numeric-desc" aria-hidden="true"></i> &nbsp;បរិមាណ <br />Qty</strong></td>
										<td class="center"><i class="fa fa-user" aria-hidden="true"></i>អ្នកធ្វើប្រតិបត្តិការ <br />Create User</strong></td>
									</tr>
								<?php if(!empty($this->productMovement))foreach($this->productMovement as $key=> $row){?>
									<tr class="hover <?php if($key%2===0)echo "line-movelist";?>">
										<td width="50px">&nbsp;&nbsp;<?php echo $key+1;?>&nbsp;&nbsp;<?php echo getSign($row['tranType']);?></td>
										<td class="right">&nbsp;&nbsp;<?php echo $row['tranTypeValue'];?></td>
										<td class="right"><i class="fa fa-calendar" aria-hidden="true"></i>&nbsp;<?php echo date("d-m-Y",strtotime($row['transDate']));?></td>
										<td class="center"><?php echo number_format($row['qty'],2).' '.$rs['measureLabel'];?></td>
										<td class="center"><?php echo $row['user'];?></td>
									</tr>
								<?php }?>
							</table>
						</td>
					</tr>
				</table>
			
			</div>
				<input type="button" onclick="doPrint();"  value="SAVE_NEW" tabindex="3" label="<?php echo $tr->translate('PRINT');?>"  dojoType="dijit.form.Button" name="save_new"
					iconClass="dijitEditorIcon dijitEditorIconPrint"/> 
			</td>
		</tr>
	</table>
</div>
<?php 
function getSign($index){
	$array = array(
			1=>'<i class="fa fa-arrow-up" aria-hidden="true"></i>',
			2=>'<i class="fa fa-arrow-up" aria-hidden="true"></i>',
			3=>'<i class="fa fa-arrow-down" aria-hidden="true"></i>',
			4=>'<i class="fa fa-arrow-down" aria-hidden="true"></i>',
			5=>'<i class="fa fa-arrow-down" aria-hidden="true"></i>',
			6=>'<i class="fa fa-arrow-up" aria-hidden="true"></i>',
			7=>'<i class="fa fa-arrows-v" aria-hidden="true"></i>',
			);
	return $array[$index];
}
?>
<script>
function doPrint() {
	window.frames["print_frame"].document.body.innerHTML=dojo.byId('divPrint').innerHTML;
    window.frames["print_frame"].window.focus();
    window.frames["print_frame"].window.print();
}
</script>