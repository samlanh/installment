<?php
$tr = Application_Form_FrmLanguages::getCurrentlanguage();
echo $this->headTitle($tr->translate('ទទួលប្លង់កម្មសិទ្ទ'));
$frm = $this->frm_loan;
?>
<script src="<?php echo $this->baseUrl();?>/js/help.js"  type="text/javascript"></script>
<script>
	dojo.require("dojo.data.ItemFileWriteStore");  
	dojo.require("dijit.form.DateTextBox");
	dojo.require("dijit.form.Textarea");
</script>
<div class="card">
	<div class="card-content collapse show">
	<form id="add_cancel" action="<?php echo $this->url(array('module'=>'loan','controller'=>'receivplong','action'=>'edit')); ?>" dojoType="dijit.form.Form" method="post" enctype="application/x-www-form-urlencoded">
		<script type="dojo/method" event="onSubmit">			
			if(this.validate()) {
     		   dijit.byId('save_close').set('disabled',true);
    			return true;
   			}else {
    			return false;
  		 	}
		</script>
		<div class="card-box">
               	<div class="col-sm-12 border-botom">
		    		<div class="col-sm-8 pd-0">
		    			<h4 class="m-b-0"><i class="fa fa-map" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<?php echo $tr->translate('ទទួលប្លង់កម្មសិទ្ទ');?></h4>
    			</div>
    			<div class="col-sm-4 text-right">
    			</div>
    		</div>
    	</div>
    	<div class="card-box">
    		<div class="col-md-6 col-sm-6 col-xs-12">
                <div class="form-group">
                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("BRANCH_NAME");?> <span class="required">*</span> :
                   </label>
                   <div class="col-md-7 col-sm-7 col-xs-12">
                    	<?php echo $frm->getElement('branch_id');?>
						<input type="hidden" name="customer_id" id="customer_id" dojoType="dijit.form.TextBox"/>
						<input type="hidden" name="house_id" id="house_id" dojoType="dijit.form.TextBox"/>
						<?php echo $frm->getElement('id');?>
                   </div>
                </div>
                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("CLIENT_NAME")?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                    	<input id="sale_client" />
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("LAYOUT_TYPE")?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                    	<input id="plong_type" />
	                   </div>
	                </div>
	              	<div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("NOTE");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                    	<input style=" min-height: 60px;" dojoType="dijit.form.Textarea" class="fullside" id="reason" name="reason" value="<?php echo $this->row['note'];?>" type="text">
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("RECEIVED_DATE");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                    	<?php echo $frm->getElement('date');?>
	                   </div>
	                </div>
            </div>
            <div class="col-md-6 col-sm-6 col-xs-12">
            	<div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("PROPERTY_INFO");?> :
	                   </label>
	                </div>
	                <div class="form-group">
	                	 <div  id="land_information" class="fullside" class="col-md-12 col-sm-12 col-xs-12" style="height: 70px; border:1px solid #aac4e6;background:#fff;">
	                   </div>
	              	</div>
            </div>
       </div>
       <div class="clearfix"></div>
		<div class="card-box">
           	<div class="col-sm-12 border-top mt-20 ptb-10 text-center">
           		<input type="submit" name="save_close" id="save_close"​​ value="រក្សាទុក​  + ចាកចេញ" label="<?php echo $tr->translate('GO_EDIT')?>" id="submitBtn" dojoType="dijit.form.Button"
	 					iconClass="dijitEditorIcon dijitEditorIconSave"/>
	 					<input type="button" value="រក្សាទុក & បោះពុម្ព" label="<?php echo $tr->translate('SAVEPRINT');?>" id="saveprint" dojoType="dijit.form.Button" 
					iconClass="dijitEditorIcon dijitEditorIconPrint" onclick="getSaleInfo();displayNone();"/>
    		</div>
    	</div>
	</form>
</div>
<div class="dijitHidden">
	<div data-dojo-type="dijit.Dialog" data-dojo-props="title:'<?php echo $tr->translate("LAYOUT_TYPE")?>'"  id="frm_plong_type" >
		<form id="form_propertytype" >
			<table style="margin: 0 auto; width: 100%;" cellspacing="7">
				<tr>
					<td>
						<input dojoType="dijit.form.ValidationTextBox" required="true" class="fullside" id="newplong_type" name="newplong_type" value="" type="text">
					</td>
				</tr>
				<tr>
					<td colspan="2" align="center">
						<input type="button" value="Save" label="<?php echo $tr->translate('GO_SAVE');?>" dojoType="dijit.form.Button"
							iconClass="dijitEditorIcon dijitEditorIconSave" onclick="addPlongType();"/>
					</td>
				</tr>
			</table>
		</form>
	</div>
</div>
<div class="dijitHidden" style="width: 25cm !important; height: 12cm ; padding: 0px; margin: 0px;">
	<div style="width: 25cm !important; " data-dojo-type="dijit.Dialog" style="text-align:center;" data-dojo-props="title:'ប័ណ្ណប្រគល់ប្លង់កម្មសិទ្ធ', onCancel:hideDialog" id="frm_receipt">
		<div id="rpt_print" >
			<style>
				body {
				    position: relative;
				}
				.border {
				        border: none;
				    display: block;
				    width: 100%;
				    height: 1px;
				    margin-bottom: 10px;
				}
				span.border-bottom-head {
				    display: inline-block;
				    border-bottom: dotted 1px #000;
				    width: 55%;
				}
				span.labelBorderBottom {
				    border-bottom: dashed 1px #000;
				    min-width: 25px;
				    display: inline-block;
					line-height: 11px;
					text-align: center;
					line-height: 20px;
				}
	  		 </style>
	  		 <table width="100%" style="font-size:12px; font-family:Tahoma,'Khmer OS Battambang'; position: relative;"> 
					<tr class="head">
						<td colspan="2" valign="middle" style="    top: 30px;  position: absolute;">
							<img alt="" src="<?php echo $this->baseUrl()."/images/logo.jpg"?>" style="max-height: 100px;display: inline-block;margin-right: 10px;">
					   </td>
					</tr>
					<tr class="head">
					   <td colspan="3" align="center">
					   		<h2 style="font-size:16px;     line-height: 14px; font-weight: initial; font-family:'Khmer OS Muol Light';" >ព្រះរាជាណាចក្រកម្ពុជា</h2>
					   		<h2 style="font-size:14px; margin-right: 7px; line-height: 14px; font-weight: initial; font-family:'Khmer OS Muol Light';">ជាតិ សាសនា ព្រះមហាក្សត្រ</h2>
					   		<img alt="" src="<?php echo $this->baseUrl()."/images/sign.PNG"?>" style=" width: 120px; margin-right: 24px;">
					   </td>
					</tr>
					
						
						<tr class="head">
						   <td colspan="3" align="center">
						   		<br />
						   		<h2 style="font-size:14px; line-height: 20px;     margin: 0; font-weight: initial; font-family:'Khmer OS Muol Light';"><span >ប័ណ្ណប្រគល់ប្លង់កម្មសិទ្ធ</span></h2>
						   		<span style="font-family:'Khmer OS Muol Light'; text-align:center; min-width: 100%; display: inline-block;">សូមបញ្ជាក់ថា</span>
						   </td>
						</tr>
						<tr>
             				<td colspan="3">
             					<br />
             					<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>បានប្រគល់</td>
										<td width="30%" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="layouttype"></span></span></td>
										<td>សម្រាប់គម្រោង</td>
										<td width="30%" align="left" ><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="LBclientProjectname"></span></span></td>
										<td><?php echo $tr->translate("PROPERTY_CODE")?></td>
										<td width="30%" align="left" ><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="LBclientPropertycode"></span></span></td>
									</tr>
									<tr>
										<td colspan="6" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" >&nbsp;</span></span></td>
									</tr>
								</table>
             					<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>ជូនអតិថិជន ឈ្មោះ</td>
										<td width="60%" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="LBclientName"></span></span></td>
										<td>&nbsp;ភេទ&nbsp;</td>
										<td width="10%">​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="LBclientGender">&nbsp;</span></span></td>
										<td>&nbsp;កាន់<span id="lbldoc_type"></span>&nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="LBclientNational">&nbsp;&nbsp;</span></span>
										</td>
									</tr>
								</table>
								<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>មានទីលំនៅ ផ្ទះលេខ ឈ្មោះ</td>
										<td width="10%" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="lbl_house"></span></span></td>
										<td>&nbsp;ផ្លូវ&nbsp;</td>
										<td width="10%">​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblstreet">&nbsp;</span></span></td>
										<td>&nbsp;ភូមិ&nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblvillage">&nbsp;&nbsp;</span></span>
										</td>
										<td>&nbsp;ឃុំ-សង្កាត់&nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblcommune">&nbsp;&nbsp;</span></span>
										</td>
										<td>&nbsp;ស្រុក-ខណ្ឌ &nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lbldistrict">&nbsp;&nbsp;</span></span>
										</td>
									</tr>
								</table>
								<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>&nbsp;ខេត្ត-ក្រុង &nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblprovince">&nbsp;<?php //echo $row['province_kh_name']?>&nbsp;</span> </span>
										</td>
										<td>ពិតប្រាកដមែន ។</td>
										<td width="80%"></td>
									</tr>
								</table>
             				</td>
             			</tr>
						<tr>
							<td colspan="3" align="center">
								<table  style=" text-align: center; width:100%;">
									<tr style="font-size: 12px;">
										<td style="width:50%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light';font-weight:200;white-space: nowrap;"><td>&nbsp;</td>
										<td style=" width:50%;  text-align:center; font-size: 14px; font-weight:200;">ធ្វើនៅថ្ងៃទី<span class="labelBorderBottom" style="min-width: 25%;">&nbsp;<span class="labelValue" id="lbl_day"></span></span>ខែ<span class="labelBorderBottom" style="min-width: 25%;">&nbsp;<span class="labelValue" id="lbl_month"></span></span>ឆ្នាំ <span class="labelBorderBottom" style="min-width: 15%;">&nbsp;<span class="labelValue" id="lbl_year"></span></span><br /><br /></td>
								   </tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="3" align="center">
								<table  style=" text-align: center; width:100%;">
									<tr style="font-size: 12px;">
										<td style="width:25%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light';font-weight:200;white-space: nowrap;">&nbsp;ស្នាមមេដៃអ្នកទទួល&nbsp;</td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;">សាក្សី</td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;">ស្នាមមេដៃអ្នកប្រគល់</td>
								   </tr>
								   <tr>
								   		<td style="height: 35px;">&nbsp;</td>
								   </tr>
								   <tr style="font-size: 12px;">
										<td style="width:25%;  text-align:center; border-bottom:dotted 1px #000; font-size: 14px; font-family:'Khmer OS Muol Light';font-weight:200;white-space: nowrap;">&nbsp;<?php //echo $row['client_namekh']?>&nbsp;</td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center;  border-bottom:dotted 1px #000; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;"></td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center;  border-bottom:dotted 1px #000; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;"></td>
								   </tr>
								</table>
								<br />
								<br />
							</td>
						</tr>
						<tr>
							<td colspan="3" style="border-top:2px dashed #000;" >
								<br />
								<br />
							</td>
						</tr>
		  		 	</table>
		</div>
		
		<table width="100%">
			<tr>
				<td align="center">
					<iframe name=print_frame width=0 height=0 frameborder=0 src=about:blank></iframe>
					<input type="button" value="បិទ" label="បិទ" id="close" dojoType="dijit.form.Button" 
						iconClass="dijitEditorIcon dijitEditorIconCancel" onclick="hideDialog();"/>
					<input type="button" value="បោះពុម្ព" label="បោះពុម្ព" id="print" dojoType="dijit.form.Button" 
						iconClass="dijitEditorIcon dijitEditorIconPrint" onclick="print();"/>
				<td>
			<tr>
		</table>
		<div id="rpt_print1" >
			<style>
				body {
				    position: relative;
				}
				.border {
				        border: none;
				    display: block;
				    width: 100%;
				    height: 1px;
				    margin-bottom: 10px;
				}
				span.border-bottom-head {
				    display: inline-block;
				    border-bottom: dotted 1px #000;
				    width: 55%;
				}
				span.labelBorderBottom {
				    border-bottom: dashed 1px #000;
				    min-width: 25px;
				    display: inline-block;
					line-height: 11px;
					text-align: center;
					line-height: 20px;
				}
	  		 </style>
	  		 <table width="100%" style="font-size:12px; font-family:Tahoma,'Khmer OS Battambang'; position: relative;"> 
					<tr class="head">
						<td colspan="2" valign="middle" style="    top: 30px;  position: absolute;">
							<img alt="" src="<?php echo $this->baseUrl()."/images/logo.jpg"?>" style="max-height: 100px;display: inline-block;margin-right: 10px;">
					   </td>
					</tr>
					<tr class="head">
					   <td colspan="3" align="center">
					   		<h2 style="font-size:16px;     line-height: 14px; font-weight: initial; font-family:'Khmer OS Muol Light';" >ព្រះរាជាណាចក្រកម្ពុជា</h2>
					   		<h2 style="font-size:14px; margin-right: 7px; line-height: 14px; font-weight: initial; font-family:'Khmer OS Muol Light';">ជាតិ សាសនា ព្រះមហាក្សត្រ</h2>
					   		<img alt="" src="<?php echo $this->baseUrl()."/images/sign.PNG"?>" style=" width: 120px; margin-right: 24px;">
					   </td>
					</tr>
					
						
						<tr class="head">
						   <td colspan="3" align="center">
						   		<br />
						   		<h2 style="font-size:14px; line-height: 20px;     margin: 0; font-weight: initial; font-family:'Khmer OS Muol Light';"><span >ប័ណ្ណប្រគល់ប្លង់កម្មសិទ្ធ</span></h2>
						   		<span style="font-family:'Khmer OS Muol Light'; text-align:center; min-width: 100%; display: inline-block;">សូមបញ្ជាក់ថា</span>
						   </td>
						</tr>
						<tr>
             				<td colspan="3">
             					
             					<br />
             					<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>បានប្រគល់</td>
										<td width="30%" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="layouttype1"><?php //echo $row['layout_type']."(".$row['propertyinfo'].")"?></span></span></td>
										<td>សម្រាប់គម្រោង</td>
										<td width="30%" align="left" ><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="LBclientProjectname1"><?php //echo $row['branch_name']?> <?php //echo "(".$row['propertyinfo'].")"?></span></span></td>
										<td><?php echo $tr->translate("PROPERTY_CODE")?></td>
										<td width="30%" align="left" ><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="LBclientPropertycode1"><?php //echo $row['propertyinfo'];?></span></span></td>
									</tr>
									<tr>
										<td colspan="6" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" >&nbsp;<?php //echo $row['layout_type']?></span></span></td>
									</tr>
								</table>
             					<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>ជូនអតិថិជន ឈ្មោះ</td>
										<td width="60%" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="LBclientName1"><?php //echo $row['client_namekh']?></span></span></td>
										<td>&nbsp;ភេទ&nbsp;</td>
										<td width="10%">​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="LBclientGender1"><?php //echo $row['sexKh']?>&nbsp;</span></span></td>
										<td>&nbsp;កាន់<span id="lbldoc_type1"></span><?php //echo $row['client_d_typekh']?>&nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="LBclientNational1">&nbsp;<?php //echo $row['nation_id']?>&nbsp;</span></span>
										</td>
									</tr>
								</table>
								<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>មានទីលំនៅ ផ្ទះលេខ ឈ្មោះ</td>
										<td width="10%" align="left"><span class="labelBorderBottom" style="min-width:100%;"><span class="labelValue" id="lbl_house1"><?php //echo $row['house']?></span></span></td>
										<td>&nbsp;ផ្លូវ&nbsp;</td>
										<td width="10%">​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblstreet1"><?php //echo $row['street']?>&nbsp;</span></span></td>
										<td>&nbsp;ភូមិ&nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblvillage1">&nbsp;<?php //echo $row['village_namekh']?>&nbsp;</span></span>
										</td>
										<td>&nbsp;ឃុំ-សង្កាត់&nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblcommune1">&nbsp;<?php //echo $row['commune_namekh']?>&nbsp;</span></span>
										</td>
										<td>&nbsp;ស្រុក-ខណ្ឌ &nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lbldistrict1">&nbsp;<?php //echo $row['district_namekh']?>&nbsp;</span></span>
										</td>
									</tr>
								</table>
								<table style="width:100%;  font-size:14px; color:inherit; white-space: nowrap;">
									<tr>
										<td>&nbsp;ខេត្ត-ក្រុង &nbsp;</td>
										<td width="15%">
										​<span class="labelBorderBottom" style="min-width: 100%;"><span class="labelValue" id="lblprovince1">&nbsp;<?php //echo $row['province_kh_name']?>&nbsp;</span> </span>
										</td>
										<td>ពិតប្រាកដមែន ។</td>
										<td width="80%"></td>
									</tr>
								</table>
             				</td>
             			</tr>
						<tr>
							<td colspan="3" align="center">
								<table  style=" text-align: center; width:100%;">
									<tr style="font-size: 12px;">
										<td style="width:50%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light';font-weight:200;white-space: nowrap;"><td>&nbsp;</td>
										<td style=" width:50%;  text-align:center; font-size: 14px; font-weight:200;">ធ្វើនៅថ្ងៃទី<span class="labelBorderBottom" style="min-width: 25%;">&nbsp;<span class="labelValue" id="lbl_day1"></span></span>ខែ<span class="labelBorderBottom" style="min-width: 25%;">&nbsp;<span class="labelValue" id="lbl_month1"></span></span>ឆ្នាំ <span class="labelBorderBottom" style="min-width: 15%;">&nbsp;<span class="labelValue" id="lbl_year1"></span></span><br /></td>
								   </tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="3" align="center" valign="top">
								<table  style=" text-align: center; width:100%;">
									<tr style="font-size: 12px;">
										<td style="width:25%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light';font-weight:200;white-space: nowrap;">&nbsp;ស្នាមមេដៃអ្នកទទួល&nbsp;</td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;">សាក្សី</td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;">ស្នាមមេដៃអ្នកប្រគល់</td>
								   </tr>
								   <tr>
								   		<td style="height: 35px;">&nbsp;</td>
								   </tr>
								   <tr style="font-size: 12px;">
										<td style="width:25%;  text-align:center; border-bottom:dotted 1px #000; font-size: 14px; font-family:'Khmer OS Muol Light';font-weight:200;white-space: nowrap;">&nbsp;<?php //echo $row['client_namekh']?>&nbsp;</td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center;  border-bottom:dotted 1px #000; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;"></td>
										<td>&nbsp;</td>
										<td style=" width:25%;  text-align:center;  border-bottom:dotted 1px #000; font-size: 14px; font-family:'Khmer OS Muol Light'; font-weight:200;"></td>
								   </tr>
								</table>
								<br />
								<br />
							</td>
						</tr>
		  		 	</table>
		</div>
	</div>
</div>
<script type="text/javascript">
function displayNone(){
	document.getElementById('rpt_print1').style.display="none";
}
var	url_getSaleInfo = '<?php echo $this->url(array('module'=>'loan','controller'=>'receivplong','action'=>'getsaleinfo'));?>';
function getSaleInfo(){
	plong_type = dijit.byId('plong_type').get('value');
	if(plong_type==-1){dijit.byId('plong_type').focus();return false;}
	sale_client = dijit.byId('sale_client').get('value');
	if(sale_client==0){
		return false;}
	if(dijit.byId('add_cancel').validate()){
		dojo.xhrPost({
			url:url_getSaleInfo,	
			content:{ 
				'sale_client': sale_client
			},
			handleAs:"json",
			load: function(data) {	
				
				document.getElementById('layouttype').innerHTML = dijit.byId('plong_type').attr('displayedValue');
				document.getElementById('LBclientProjectname').innerHTML = dijit.byId('branch_id').attr('displayedValue');
				document.getElementById('LBclientPropertycode').innerHTML =data.propertyInfo;
				
				document.getElementById('LBclientName').innerHTML = data.client_namekh;
				document.getElementById('LBclientGender').innerHTML = data.sexKh;
				document.getElementById('lbldoc_type').innerHTML = data.client_d_typekh;
				document.getElementById('LBclientNational').innerHTML = data.nation_id;
				document.getElementById('lbl_house').innerHTML = data.house;
				document.getElementById('lblstreet').innerHTML = data.street;
				document.getElementById('lblvillage').innerHTML = data.village_namekh;
				document.getElementById('lblcommune').innerHTML = data.commune_namekh;
				document.getElementById('lbldistrict').innerHTML = data.district_namekh;
				document.getElementById('lblprovince').innerHTML = data.province_kh_name;

				document.getElementById('layouttype1').innerHTML = dijit.byId('plong_type').attr('displayedValue');
				document.getElementById('LBclientProjectname1').innerHTML = dijit.byId('branch_id').attr('displayedValue');
				document.getElementById('LBclientPropertycode1').innerHTML =data.propertyInfo;
				document.getElementById('LBclientName1').innerHTML = data.client_namekh;
				document.getElementById('LBclientGender1').innerHTML = data.sexKh;
				document.getElementById('lbldoc_type1').innerHTML = data.client_d_typekh;
				document.getElementById('LBclientNational1').innerHTML = data.nation_id;
				document.getElementById('lbl_house1').innerHTML = data.house;
				document.getElementById('lblstreet1').innerHTML = data.street;
				document.getElementById('lblvillage1').innerHTML = data.village_namekh;
				document.getElementById('lblcommune1').innerHTML = data.commune_namekh;
				document.getElementById('lbldistrict1').innerHTML = data.district_namekh;
				document.getElementById('lblprovince1').innerHTML = data.province_kh_name;

				date_payment = dijit.byId("date").get('value');
				var a = new Date(date_payment);
				mm = a.getMonth()+1;
				var dd = a.getDate();
				 if(dd<10){
					 dd = "0"+dd;
				}
				month = returnMOnth(mm);
				var y = a.getFullYear();

				document.getElementById('lbl_day').innerHTML = dd;
				document.getElementById('lbl_month').innerHTML = month;
				document.getElementById('lbl_year').innerHTML = y;
				
				document.getElementById('lbl_day1').innerHTML = dd;
				document.getElementById('lbl_month1').innerHTML = month;
				document.getElementById('lbl_year1').innerHTML = y;
				
				dijit.byId('frm_receipt').show();
			},
			error: function(err) {
				alert(err);
			}
		});
	}
}
function returnMOnth(monthnum){
	var month = new Array();
	month[1] = "Jan";
	month[2] = "Feb";
	month[3] = "Mar";
	month[4] = "Apr";
	month[5] = "May";
	month[6] = "Jun";
	month[7] = "Jul";
	month[8] = "Aug";
	month[9] = "Sep";
	month[10] = "Oct";
	month[11] = "Nov";
	month[12] = "Dec";
	return month[monthnum];
}
function hideDialog() {		
	dijit.byId("frm_receipt").hide();
}
function print(){
	window.frames["print_frame"].document.body.innerHTML=dojo.byId('rpt_print').innerHTML + dojo.byId('rpt_print1').innerHTML;
    window.frames["print_frame"].window.focus();
    window.frames["print_frame"].window.print();
    dijit.byId("frm_receipt").hide();
    dijit.byId('save_close').set('disabled',true);
    dijit.byId('saveprint').set('disabled',true);
    dijit.byId('add_cancel').submit()
}
var sale_client_store  = getDataStorefromJSON('id','name', <?php print_r(Zend_Json::encode(array()));?> );
var plongtype_store  = getDataStorefromJSON('id','name', <?php print_r(Zend_Json::encode($this->layouttype));?> );
dojo.ready(function(){
	try{
		new dijit.form.FilteringSelect({
			store: sale_client_store,
			autoComplete: true,
			required: false,		           
			name: "sale_client",
			id: "sale_client",
			searchAttr: "name",
			value: "<?php echo $this->row['sale_id'];?>",
			class: 'fullside',
				onChange: function() {
					getLandAndClientDetail("2");
				}
			}, "sale_client");
		new dijit.form.FilteringSelect({
			store: plongtype_store,
			autoComplete: true,
			required: true,		           
			name: "plong_type",
			id: "plong_type",
			searchAttr: "name",
			value: "<?php echo $this->row['layout_type'];?>",
			class: 'fullside',
				onChange: function() {
					plong_type = dijit.byId('plong_type').get('value');
					if(plong_type==-1){
						dijit.byId('frm_plong_type').show();
					}
				}
			}, "plong_type");
		
		getSaleClie();

		}catch(e){
			alert(e);
		}
});

function addPlongType(){
	var Itemmake = {					
			id: dijit.byId('newplong_type').get('value'),
		    name: dijit.byId('newplong_type').get('value')
	};		
	addDataToSelectbox(dijit.byId('plong_type'), plongtype_store, Itemmake, dijit.byId('newplong_type').get('value'));	
	dijit.byId('plong_type').attr('value',dijit.byId('newplong_type').get('value'));
	dijit.byId('frm_plong_type').reset();
	dijit.byId('frm_plong_type').hide();
}
	var	url_getSaleClien = '<?php echo $this->url(array('module'=>'loan','controller'=>'cancel','action'=>'get-saleclie'));?>';
	function getSaleClie(){
		branch_id = dijit.byId('branch_id').get('value');
		if(branch_id==0){
			return false;}
		dojo.xhrPost({
			url:url_getSaleClien,	
			content:{ 
				'branch_id': branch_id, 'sale_id':'',
			},
			handleAs:"json",
			load: function(data) {	
				sale_client_store  = getDataStorefromJSON('id','name', data);		
			    dijit.byId('sale_client').set('store', sale_client_store);
			    dijit.byId('sale_client').attr('value',   <?php echo $this->row['sale_id'];?>);
			},
			error: function(err) {
				alert(err);
			}
		});
	}
	var url_land= '<?php echo $this->url(array('module'=>'loan','controller'=>'cancel','action'=>'get-info'));?>';
	function getLandAndClientDetail(inds){
			sale_id = dijit.byId('sale_client').get('value');
		dojo.xhrPost({
			url:url_land,	
			content:{ 
			    'sale_id':sale_id
			},		    
			handleAs:"json",
			load: function(data) {
				dijit.byId("customer_id").attr("value",data.client_id);
				dijit.byId("house_id").attr("value",data.house_id);
				dojo.byId('land_information').innerHTML ="លេខសម្គាល់  : "+data.land_code+", ឈ្មោះ  :  "+data.land_address+", ផ្លូវ : "+data.street+", ប្រភេទ   : "+data.pro_type+", ទំហំ  : "+data.land_size+", បណ្តោយ :  "+data.height+",ទទឹង  :  "+data.width;
			},
			error: function(err) {
				alert(err);
			}
		});
	}
</script>